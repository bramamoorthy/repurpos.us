.. _concepts:

========
Concepts
========
File Formats

Indigo supports the following molecule and reaction formats:

Daylight SMILES with ChemAxon extensions
Daylight SMARTS (including reactions)
CML (including reactions)
MDL (Symyx) Molfile and Rxnfile, both v2000 and v3000
MDL (Symyx) SDFile and RDFile
All the above in GZip-compressed form
Daylight Formats with ChemAxon and CurlySMILES Extensions

Almost all features of the original Daylight SMILES format are supported, including:

Aromatic rings
Hydrogen counters
Tetrahedral and allene-like stereocenters
Cis-trans double bonds
Disconnected structures
Reaction atom-to-atom mapping (AAM)
The only features that are not supported are:

"Up or unspecified", "down or unspecified" notation ("/?", "\?")
Square-planar, trigonal-bipyramidal, and octahedral stereo configurations.
Almost all features of the original Daylight SMARTS format are supported, including:

Aromatic and aliphatic atoms
SSSR (smallest set of smallest rings) calculation
Logical operators
Atom environments (nested SMARTS)
Component-level grouping
The only features that are not supported are:

Constraint "h" (implicit hydrogen count). Hydrogens can be stored implicitly or explicitly in the database, and this difference should not affect the search results. "H" (total hydrogen count) may be used instead
All features of SMILES format that are not supported
The following ChemAxon SMILES extensions are supported:

Radical numbers: monovalent, divalent singlet, and divalent triplet
Stereogroups
Pseudo-atoms (atom aliases)
Fragment level grouping in reactions
The following extensions from the CurlySMILES format are supported:

Simple polymers: {-}...{+n}
Multiple groups: {-}...{+nn=5} 
MDL Formats

MDL (Symyx) Molfiles and Rxnfiles are supported by Indigo. Both format versions (2000 and 3000) are supported. Almost all format features are supported, including:

Pseudo-atoms (atom aliases)
Stereogroups
R-Groups (Markush queries)
Query atoms and query bonds
Various query flags on atoms and bonds
Atom positions
3D constraints in v2000 Molfiles
Reaction atom-to-atom mapping (AAM)
Reacting centers and stereo inv/ret flags
Data SGroups, polymers, superatoms (abbreviations)
The only features that are not supported are:

3D constraints in v3000 Molfiles
Molecules and Query Molecules

Indigo treats "real" molecules different from query molecules in certain ways.

Only a query molecule can contain query features like "any" atoms, atom lists, etc.
Only a query molecule can contain R-Groups (although R-Sites can be present in "real" molecule too)
Only a query molecule can be matched as a substructure
Only a "real" molecule can be matched against by the substructure matcher.
Only "real" molecules can be subject to MCS/common scaffold computation.
Canonical SMILES can be calculated only on "real" molecules.
Similar rules apply to "real" reactions and query reactions:

Only a query reaction can be matched as a substructure in the reaction substructure matcher.
Only a "real" reaction can be matched against by the reaction substructure matcher.
There is never an ambiguity whether a particular object is a molecule/reaction or query molecule/reaction. While most input formats (Molfile/Rxnfile, SMILES) can store both types, different calls are provided for loading them as "real" or query objects. SMARTS strings always are loaded as query molecules, for obvious reasons.

Substructure and SMARTS Matching

Indigo provides full capabilities for substructure matching of query molecules, including ones loaded from SMARTS expressions. In the Bingo User Manual, you can find examples of substructure matches.

Differences between SMARTS and query SMILES

While a lot of SMARTS notation is allowed when loading SMILES as a query, there are differences between SMARTS and query SMILES:

SMARTS fragments $(...) are not allowed in query SMILES.

Empty bond designator (like 'CC' or 'cc') denotes 'single or aromatic' bond in SMARTS. In query SMILES, it denotes aromatic bond, if it belongs to a ring and has both end atoms aromatic (lowercase); otherwise, it denotes a single bond.

'C' within SMARTS means aliphatic carbon, while 'C' within query SMILES means any carbon. The same applies to 'B', 'N', 'O', 'S', 'P'. 'C1~C~C~C~C~C~1' won't match 'c1ccccc1' as SMARTS, but it will do so as query SMILES.

SMARTS queries are not fed to aromaticity matcher. 'c1-c=c-c=c-c=1' won't match 'c1ccccc1' as SMARTS, but it will do so as query SMILES.

Exact Matching

Indigo can perform exact matching of pairs of molecules, or pairs of reactions.

Molecule Similarity

Indigo provides various molecule similarity measures, all based on originally developed fingerprints. In the Bingo User Manual, you can find detailed description and examples.

Canonical SMILES

Canonical SMILES generated by Indigo are, according to Daylight and ChemAxon terminology, unique SMILES with isomeric information, or absolute SMILES. All significant molecular features, such as isotopes, charges, radicals, stereocenters, stereogroups, cis-trans bonds, and aromaticity, are encoded into SMILES in a canonical form. A canonical SMILES string defines the molecule independently of any particular representation (atom renumbering, stereogroup renumbering, explicit/implicit hydrogens). So, the equality of the canonical SMILES of two molecules guarantees that these molecules are the same, and vice versa.


